# 前端性能优化

## 内容与资源优化
更多优化方案参考:[传送门](https://juejin.im/post/5b0b7d74518825158e173a0c)
- 尽量减少HTTP请求数

通过合并文件和雪碧图来减少请求数，一般使用gulp或者webpack即可
- 懒加载图片

如果网站涉有多图片可以使用图片的懒加载，首屏图片也是渲染完dom再进行加载，提高访问速度，可以使用[lazysizes](https://github.com/aFarkas/lazysizes)，或者使用自己封装懒加载插件[传送门](https://github.com/ymblog/plugin/blob/master/js/lazyLoading.js)
- 页面预加载

可以使用svg或者图片设置布局灰色的预加载页面，先显示出布局轮廓如(简书)，大型单页面应用比较需要

- 图片处理

使用图片必须进行压缩(移动端图片最好使用3@)，压缩网站为:[compressjpeg](https://compressjpeg.com/zh/)（推荐）、[tinypng](https://tinypng.com/)。而且网站的图片尺寸需要设置合理，gulp或者webpack

移动端使用宽度百分比，高度自动拉伸。使用如下优化，防止页面布局抖动

```
  .img-box{
    padding-bottom: xx%;//高度相对于图片宽度的比例
    height: 0;
    overflow: hidden;
    background: #f8f8f8;
  }
```
- DNS Prefetch

DNS Prefetch是一种DNS预解析技术，当我们浏览网页时，浏览器会在加载网页时对网页中的域名进行预解析并缓存，这样在浏览器加载网页中的链接时，就无需进行DNS解析，减少用户的等待时间，提高用户体验。

## webview优化
参考[美团webview优化解决方案](http://tech.meituan.com/WebViewPerf.html)

## 高级优化-滚动节流

滚动函数的节流,不然在滚动期间一段距离执行很多次函数
```
function throttle(func, wait, mustRun) {
    var timeout,
        startTime = new Date();
    return function() {
        var context = this,
            args = arguments,
            curTime = new Date();
        clearTimeout(timeout);
        // 如果达到了规定的触发时间间隔，触发 handler
        if(curTime - startTime >= mustRun){
            func.apply(context,args);
            startTime = curTime;
        // 没达到触发间隔，重新设定定时器
        }else{
            timeout = setTimeout(func, wait);
        }
    };
};
window.addEventListener('scroll',throttle(realFunc,500,1000));
功能就是如果在一段时间内 scroll 触发的间隔一直短于 500ms ，那么能保证事件我们希望调用的 handler 至少在 1000ms 内会触发一次
```